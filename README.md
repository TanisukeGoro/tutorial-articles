Laravelで全然意味わからんEloquentのチュートリアル。これで分かるようになると、いいな...

# Eloquentの基本

Laravelには標準で`Eloquent`と呼ばれるORMが内蔵されています。  
`ORM`とは`Object-Relational Mapping`といって、データベースのレコードをプログラミング言語のオブジェクトとして扱う仕組みです。  
ここでは`Eloquent`がなぜ必要なのかについて概観したのちに、実際にデータベースの管理を行なってみます。

## ORMの概要

ORMでは以下の機能を提供しているようです。

1. データベースからデータを取得する
2. 取得したデータをオブジェクト化する
3. データの更新・変更などをデータベースに格納する

これまでは`DBクラス`を使って以下のようにSQL文を書いていたと思います。

```php
(DB::select('select * from users where id = :id', ['id' => 1]);
```

この方法だと毎回SQLのクエリ文を作成する必要がありますが、クエリビルダを利用すると直感的にデータを取得することができたのでそこまで不便に思いませんでした。

ところで、これらの方法で取り出すとレコードの値は連想配列としてまとめられたものが、さらに配列やコレクションにまとめられています。
以下に一例示します。

```php
$record[1] = [
  'id' => 1,
  'name' => 'hoge hage',
  'email' => 'hoge@email.com',
  'created_at' => '2016-10-08 00:00:00'
  'updated_at' => '2016-10-08 00:00:00'
]
```

正直、こういった感じで値が取得できるのであれば、PHP初心者、Laravel初心者としても十分な気がします。  
しかしどうも本業の方はそうではないようです。

『掌田 津耶乃著 PHPフレームワーク Laravel入門 (2017) 』によると
> 
> (連想配列的にデータを扱うことが)PHPらしい感じではないのも確かでしょう。  
> データベースのテーブルやレコードというのは、PHPのクラスなどとは基本的な仕組みが違います。  
> (中略)  
> 全く構造の異なるレコードをPHPの中に取り込もうとすると「全部、データは連想配列にまとめてしまえ」となるのはやむを得ないことでしょう。  
> もし、テーブルをPHPのクラスのように定義して、レコードをクラスのインスタンスのように扱えたなら、随分とPHPらしい処理になると思いませんか？  
> 

といった感じで、データベースのレコードを`オブジェクトとして扱うことがPHPらしく扱いやすいものとなる`といった思想があるようです。    
そしてこの思想のもとで作られているのが`ORM (Eloquent)`なのではないでしょうか。  
 

前述のORMの機能でも述べましたが、ORMはデータベースからデータを取得してオブジェクト化しています。  
ではオブジェクト化されたデータとはなんなのでしょうか。  

## オブジェクト化とはなんぞ？

オブジェクトは`オブジェクト指向`ではなく、オブジェクトです。
「オブジェクトとはモノだ！」という説明がありますが、ちょっとわかりにくいし説明になっていない気がします。

個人的に分かりやすかった説明として

>  オブジェクトはデータと処理のまとまり  
> [もっとORMを使えるようになりたいので、見直してみた - Qiita](https://qiita.com/niisan-tokyo/items/156eb35c6eeaf07b9b65)
> 

というものがあります。

これまではデータを連想配列で取得して、それに付随した処理は別で記述していたかもしれません。  
しかし実際のところ、あるデータがあった時、そのデータに対する処理の方法もだいたい決まっているかと思います。

すると、`データ`と`処理`をまとめておくことという考え方はごく自然な概念のように思えます。

さて、この単純な概念のもとで、まさにデータの塊であるデータベースをオブジェクトを使って処理したいと思った時、自前でオブジェクトをつくりますか？  
元々は必要だったかもしれませんが、これらの知見が溜まって一般化されたものがORMとしてLaravelでは提供されているわけです。

## LaravelのORM: Eloquent

さて、これでなんとなくEloquentが何なのか、何故必要なのかが少し腹落ちしたかと思います。  
私は少しだけ見通しがたったかのように思います。
あああ
aaa
a
aaa


















